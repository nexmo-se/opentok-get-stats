(()=>{"use strict";function t(t){const e=function(){return this.startTestTime=0,this.prevAudioTimestamp=0,this.prevAudioPacketsLost=0,this.prevAudioPacketsRcvd=0,this.prevAudioBytes=0,this.audioPLRatio=0,this.audioBw=0,this.audioOnlyThreshold=25e3,this.audioPLThreshold=.05,this.runInterval=null,this.runIntervalTimeout=1e3,this.testDone=!1,this.result=null,{result:this.result,run:function(t){return new Promise((e=>{this.runInterval=setInterval((async()=>{this.testDone?(clearInterval(this.runInterval),e(this.result)):(0===this.startTestTime&&(this.startTestTime=Date.now()/1e3),await async function(t){let e=Date.now()/1e3;if(t)return new Promise(((s,i)=>{t.getStats(((t,o)=>{if(t)return i(t);if(console.log("Stats",o),0===this.prevAudioTimestamp&&(this.prevAudioTimestamp=e,this.prevAudioBytes=o.audioBytesReceived),e-this.prevAudioTimestamp>=3){if(0!==this.prevAudioPacketsRcvd){const t=o.audioPacketsLost-this.prevAudioPacketsLost;let e=t+(o.audioPacketsReceived-this.prevAudioPacketsRcvd);e>0&&(this.audioPLRatio=t/e)}this.prevAudioPacketsLost=o.audioPacketsLost,this.prevAudioPacketsRcvd=o.audioPacketsReceived,this.audioBw=8*(o.audioBytesReceived-this.prevAudioBytes)/(e-this.prevAudioTimestamp),this.prevAudioTimestamp=e,this.prevAudioBytes=o.audioBytesReceived,console.log("checkAudioStats",this.audioBw),s()}}))}))}(t),Date.now()/1e3-this.startTestTime>20&&(this.result=function(){return this.testDone=!0,this.audioBw<this.audioOnlyThreshold||this.audioPLRatio>this.audioPLThreshold?{result:"BANDWIDTH_TOO_LOW"}:{result:"AUDIO_ONLY"}}(),clearInterval(this.runInterval),e(this.result)))}),this.runIntervalTimeout)}))}}}();console.log("audioStatsObj",e);const s=e.run(t);console.log("audioResults",s)}var e,s;function i(t){t&&console.error(t)}document.getElementById("get-stats").addEventListener("click",(function(){t(e)})),(s=OT.initSession("46501052","2_MX40NjUwMTA1Mn5-MTYwNzUxNzA0MzI0OX5mbzFOY044MTNIUE9nR25UMVluVzNyc21-fg",{})).on("streamCreated",(function(t){s.subscribe(t.stream,"subscriber",{insertMode:"append",width:"100%",height:"100%"},i)})),s.on("sessionDisconnected",(function(t){console.log("You were disconnected from the session.",t.reason)})),s.connect("T1==cGFydG5lcl9pZD00NjUwMTA1MiZzaWc9ZDIyMmQ0N2IyMmI4YWRjZDE0MDBmN2I3OTYyZDc4MmJhMTY5Zjc4MTpzZXNzaW9uX2lkPTJfTVg0ME5qVXdNVEExTW41LU1UWXdOelV4TnpBME16STBPWDVtYnpGT1kwNDRNVE5JVUU5blIyNVVNVmx1VnpOeWMyMS1mZyZjcmVhdGVfdGltZT0xNjA3NTE3MDU1Jm5vbmNlPTAuODc1NTQwNjk2NjQwMzA1OSZyb2xlPXB1Ymxpc2hlciZleHBpcmVfdGltZT0xNjEwMTA5MDU0JmluaXRpYWxfbGF5b3V0X2NsYXNzX2xpc3Q9",(async function(t){t?i(t):(console.log("Connected",e),s.publish(e,i))}))})();